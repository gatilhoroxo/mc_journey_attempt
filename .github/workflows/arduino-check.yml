name: ðŸ§ª Arduino Syntax Check

on:
  push:
    branches: [ main, develop ]
    paths:
      - 'mcu/i0-arduino/**/*.ino'
  pull_request:
    branches: [ main ]
    paths:
      - 'mcu/i0-arduino/**/*.ino'

jobs:
  arduino-syntax:
    runs-on: ubuntu-latest
    
    strategy:
      matrix:
        fqbn:
          - "arduino:avr:uno"
          - "arduino:avr:mega"
    
    steps:
    - name: ðŸ“¥ Checkout code
      uses: actions/checkout@v4
      
    - name: ðŸ”§ Setup Arduino CLI
      uses: arduino/setup-arduino-cli@v1
      
    - name: ðŸ“¦ Install Arduino cores
      run: |
        arduino-cli core update-index
        arduino-cli core install arduino:avr
        
    - name: ðŸ§ª Compile sketches
      run: |
        # Encontrar todos os arquivos .ino
        find mcu/i0-arduino -name "*.ino" | while read sketch; do
          echo "Compiling: $sketch"
          arduino-cli compile --fqbn ${{ matrix.fqbn }} "$sketch" || echo "Failed: $sketch"
        done
        
    - name: âœ… Summary
      if: always()
      run: |
        echo "### Arduino Compilation Results" >> $GITHUB_STEP_SUMMARY
        echo "Board: ${{ matrix.fqbn }}" >> $GITHUB_STEP_SUMMARY
